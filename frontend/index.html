<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kindle Snippet Filter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h1>Kindle Snippet Filter</h1>
            <input type="file" id="fileInput" accept=".txt">
            <div id="filterSection">
                <label for="bookFilter">Filter by Book:</label>
                <input type="text" id="bookFilter" placeholder="Enter book title">
                
                <label for="authorFilter">Filter by Author:</label>
                <input type="text" id="authorFilter" placeholder="Enter author name">
            </div>
            <button id="filterButton">Filter Highlights</button>
            <button id="exportButton">Export Results</button>
        </div>
        <div class="content">
            <div id="results"></div>
        </div>
    </div>
    <script src="script.js" type="module"></script>
    <script type="module">
        import * as wasm from './pkg/kindle_clippings.js';

        wasm.default().then((module) => {
            function displayResults(highlights) {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = highlights.map(h => `
        <div class="highlight">
            <p><strong>Book:</strong> ${h.title}</p>
            <p><strong>Author:</strong> ${h.author}</p>
            <p>${h.content}</p>
        </div>
    `).join('');
            }

            let highlights = [
                //new wasm.Entry("title", "author", "action", 1, "loc", "2020", "content")
            ];

            document.getElementById('fileInput').addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        highlights = wasm.parse_clippings(e.target.result);
                        displayResults(highlights);
                        console.log(highlights);
                    };
                    reader.readAsText(file);
                }
            });
        });

    </script>

</body>
</html>

